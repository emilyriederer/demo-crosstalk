"0","library(dplyr)"
"0","library(leaflet)"
"0","library(DT)"
"0","library(ggplot2)"
"0","library(plotly)"
"0","library(crosstalk)"
"0","library(htmltools)"
"0",""
"0","# create SharedData ----"
"0","trips_apr_ct <- "
"0","  trips_apr %>%"
"0","  select(stationname, lon, lat, "
"0","         year_2019, year_2020, pct_change, prop_wend_2019) %>%"
"0","  mutate_at("
"0","    vars(lon, lat, pct_change, prop_wend_2019),"
"0","    round, 2"
"0","  ) %>%"
"0","  SharedData$new(key = ~stationname)"
"0",""
"0","# create individual widgets ----"
"0","lf <- leaflet(trips_apr_ct) %>% addTiles() %>% addMarkers()"
"2","Assuming ""lon"" and ""lat"" are longitude and latitude, respectively
"
"0","dt <- datatable(trips_apr_ct,"
"0","                fillContainer = TRUE,"
"0","                rownames = FALSE,"
"0","                colnames = c(""Station"", ""Lon"", ""Lat"","
"0","                             ""2019 Rides"", ""2020 Rides"", "
"0","                             ""% Change"", ""% Weekend 2019""))"
"0",""
"0","gg <- ggplot(trips_apr_ct) +"
"0","    aes("
"0","      x = prop_wend_2019, "
"0","      y = pct_change,"
"0","      col = pct_change,"
"0","      name = stationname) +"
"0","    geom_point() +"
"0","    guides(col = FALSE) +"
"0","  labs("
"0","    x = ""% Apr 2019 Trips on Weekend"","
"0","    y = ""% Change Apr 2020 vs 2019"""
"0","  ) +"
"0","  scale_x_continuous(labels = scales::percent) +"
"0","  scale_y_continuous(labels = scales::percent)"
"0","gg_ly <- "
"0","  ggplotly(gg, tooltip = ""name"") %>%"
"0","  highlight(on = ""plotly_selected"","
"0","            off = ""plotly_doubleclick"")"
"0",""
"0","# create final output ----"
"0","bscols("
"0","  div(h3(""Chicago CTA Trips - April 2019 vs 2020"")),"
"0","  gg_ly, lf, "
"0","  dt, "
"0","  widths = c(12, 6, 6, 12))"
"2","Sum of bscol width units is greater than 12"
